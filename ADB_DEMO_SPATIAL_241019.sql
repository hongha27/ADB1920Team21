CREATE DATABASE ADB241019
GO

USE ADB241019
GO

DROP TABLE DATDAI

CREATE TABLE DATDAI(
	ID INT IDENTITY(1,1) PRIMARY KEY,
	CMND VARCHAR(15),
	HOTEN NVARCHAR(150),
	VITRI GEOMETRY,
)
GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('2251251251','A',GEOMETRY::STPolyFromText('POLYGON((1 3,5 2,7 3,7 6,1 6,1 3),(2 0,2 1,-1 1,2 0))',4326));
GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('2251251212','B',GEOMETRY::STPolyFromText('POLYGON((1 3,1 6,-4 6,-4 3,1 3))',4326));
GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('2958U298U64','E',GEOMETRY::STPolyFromText('POLYGON((5 2,9 2,9 6,7 6,7 3,5 2))',4326));

GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('2251218751','C',GEOMETRY::STPolyFromText('POLYGON((-4 1,-4 -2,2 -2,2 0,-1 1,-4 1))',4326));

GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('2224791251','D',GEOMETRY::STPolyFromText('POLYGON((2 -2,9 -2,9 0,2 1,2 -2))',4326));
GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('1561891925','F',GEOMETRY::STPolyFromText('POLYGON((9 2,10 2,10 5,15 5,15 6,9 6,9 2))',4326));
GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('8498624564','G',GEOMETRY::STPolyFromText('POLYGON((10 2,15 3,15 5,10 5,10 2))',4326));
GO

INSERT INTO DATDAI(CMND,HOTEN,VITRI) VALUES
('4924654984','H',GEOMETRY::STPolyFromText('POLYGON((9 0,9 -2,15 -2,15 1,9 0))',4326));
GO

DECLARE @DUONG GEOMETRY
SET @DUONG = GEOMETRY::STPolyFromText('POLYGON((1 3,1 6,-4 6,-4 3,1 3))',4326);

--SELECT @DUONG.STArea();
SELECT HOTEN,VITRI.MakeValid().STIntersection(@DUONG).STArea() as DTMAT
FROM DATDAI